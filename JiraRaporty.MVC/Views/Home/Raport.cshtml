@model JiraRaporty.MVC.Models.RaportViewModel

@{
    ViewData["Title"] = "Generate Report";
}

<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h3>Generate Jira Report</h3>
            </div>
            <div class="card-body">
                <form asp-action="ExportToExcel" method="post">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="FromDate" class="control-label">From Date</label>
                                <input type="date" id="FromDate" name="FromDate" class="form-control" value="@DateTime.Today.AddDays(-7).ToString("yyyy-MM-dd")" required />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="ToDate" class="control-label">To Date</label>
                                <input type="date" id="ToDate" name="ToDate" class="form-control" value="@DateTime.Today.ToString("yyyy-MM-dd")" required />
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group mb-3">
                        <label for="ProjectList" class="control-label">Select Projects</label>
                        <select id="ProjectList" name="ProjectList" class="form-control" multiple required>
                            @foreach (var project in Model.Projects)
                            {
                                <option value="@project.Key">@project.Name</option>
                            }
                        </select>
                    </div>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="InLocal" name="InLocal" value="true" />
                        <label class="form-check-label" for="InLocal">
                            Include Local Summary
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <input type="submit" value="Generate Excel Report" class="btn btn-primary" />
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // You can add a multi-select plugin here if needed
        });
    </script>
}